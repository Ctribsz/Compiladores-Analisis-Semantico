<!doctype html>
<html lang="es" data-theme="light">
<head>
  <meta charset="utf-8" />
  <title>Compiscript IDE</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg: #0b0d10;
      --bg-soft: #11151a;
      --panel: #12171d;
      --panel-2: #0e1318;
      --text: #e7edf3;
      --muted: #9fb0c0;
      --accent: #4cc9f0;
      --accent-2: #00e5a8;
      --border: #1f2a36;
      --ok: #65d26e;
      --err: #ff6b6b;
      --warn: #f6c85f;
      --chip: #1a2330;
      --btn: #17202a;
      --btn-h: #1c2835;
      --shadow: 0 8px 24px rgba(0,0,0,.25);
      --radius: 14px;
    }
    [data-theme="light"]{
      --bg: #f6f7fb;
      --bg-soft: #ffffff;
      --panel: #ffffff;
      --panel-2: #f7f9fc;
      --text: #0e1726;
      --muted: #5c6b7a;
      --accent: #2563eb;
      --accent-2: #059669;
      --border: #e6eaf0;
      --ok: #0ea45b;
      --err: #e11d48;
      --warn: #b45309;
      --chip: #eef2f7;
      --btn: #eef2f7;
      --btn-h: #e4eaf2;
      --shadow: 0 10px 30px rgba(23,34,45,.08);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji"; color: var(--text); background: linear-gradient(180deg, var(--bg-soft), var(--bg)); }
    .app { display: grid; grid-template-rows: auto 1fr; height: 100%; }

    /* Toolbar */
    .toolbar {
      display:grid; grid-template-columns: 1fr auto; gap: 12px;
      padding:12px 16px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      position: sticky; top:0; z-index:10;
      box-shadow: var(--shadow);
    }
    .leftTools { display:flex; align-items:center; gap:10px; }
    .rightTools { display:flex; align-items:center; gap:10px; justify-content:flex-end; }
    .brand { display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px; }
    .brand .logo {
      width:28px; height:28px; border-radius:8px;
      background: radial-gradient(60% 60% at 30% 30%, var(--accent), transparent 60%),
                  radial-gradient(60% 60% at 70% 70%, var(--accent-2), transparent 60%),
                  linear-gradient(135deg, var(--chip), transparent);
      box-shadow: inset 0 0 0 1px var(--border), 0 4px 14px rgba(0,0,0,.15);
    }

    .btn {
      appearance:none; border:1px solid var(--border); background: var(--btn);
      color:var(--text); padding:8px 12px; border-radius:10px; cursor:pointer;
      font-weight:600; transition: all .15s ease;
      display:inline-flex; align-items:center; gap:8px;
    }
    .btn:hover { background: var(--btn-h); transform: translateY(-1px); }
    .btn.primary { border-color: transparent; background: linear-gradient(90deg, var(--accent), var(--accent-2)); color:#fff; }
    .btn.primary:hover { filter: brightness(1.05); }

    .chip {
      padding:6px 10px; border-radius:999px; font-size:12px; background: var(--chip);
      border:1px solid var(--border); color: var(--muted);
    }
    .chip.ok { color: var(--ok); }
    .chip.err { color: var(--err); }
    .chip.warn { color: var(--warn); }

    /* Layout */
    .workspace { display:grid; grid-template-columns: 1fr 6px 420px; gap:0; height: calc(100vh - 64px); }
    .editor-wrap { position: relative; padding: 16px; }
    .editor-card {
      height: 100%;
      background: var(--panel);
      border:1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
    }

    /* Splitter */
    .splitter { width: 6px; cursor: col-resize; background: transparent; position: relative; }
    .splitter::after {
      content: ""; position: absolute; top: 16px; bottom: 16px; left: 2px; right: 2px; border-radius: 6px; background: var(--border);
    }

    /* Side panel */
    .side { display:flex; flex-direction:column; gap:12px; padding:16px; border-left:1px solid var(--border); background: transparent; }
    .panel {
      background: var(--panel);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      display:flex; flex-direction:column;
      min-height: 160px;
    }
    .panel .head {
      display:flex; align-items:center; gap:8px; padding:10px 12px; border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
    }
    .tabs { display:flex; gap:6px; }
    .tab {
      padding:6px 10px; border-radius:8px; cursor:pointer; font-weight:600; color:var(--muted);
      border:1px solid transparent;
    }
    .tab.active { color:var(--text); background: var(--chip); border-color: var(--border); }
    .panel .body { padding:12px; overflow:auto; height: 100%; }

    /* Listados */
    .msg-ok { color: var(--ok); font-weight:700; }
    .err {
      padding: 8px 10px; border-radius:10px; margin-bottom:8px;
      background: rgba(255, 107, 107, .1); border:1px solid rgba(255, 107, 107, .35);
      color: var(--err); font-weight:600; cursor:pointer;
    }
    .muted { color: var(--muted); }
    code.inline { padding:2px 6px; border-radius:6px; background: var(--chip); border: 1px solid var(--border); }

    /* Symbols */
    .scope-block { padding: 8px 10px; border-radius:10px; border:1px dashed var(--border); margin-bottom:8px; }
    .sym-list { list-style: none; padding-left: 0; margin: 6px 0 0; }
    .sym-list li { margin: 4px 0; }
    .sym-kind { opacity:.7; margin-right:6px; }
    .sym-name { font-weight:700; }
    .sym-type { opacity:.8; }

    /* Hidden input (accesible) */
    #uploadInput {
      position: absolute; width: 1px; height: 1px; padding:0; margin:-1px; overflow:hidden;
      clip: rect(0,0,0,0); border:0;
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="toolbar">
      <div class="leftTools">
        <div class="brand">
          <div class="logo"></div>
          <div>Compiscript IDE</div>
          <span class="chip" id="statusChip">Listo</span>
        </div>
        <span id="filename" class="muted"></span>
      </div>

      <div class="rightTools">
        <input id="uploadInput" type="file" accept=".cps" />
        <button id="uploadBtn" type="button" class="btn">Subir .cps</button>
        <button id="themeToggle" type="button" class="btn" title="Tema claro/oscuro">üåë Oscuro</button>
        <button id="analyze" type="button" class="btn primary">Analizar (Ctrl/Cmd + Enter)</button>
      </div>
    </header>

    <main class="workspace" id="workspace">
      <section class="editor-wrap">
        <div class="editor-card">
          <div id="editor" style="height:100%; width:100%;"></div>
        </div>
      </section>

      <div class="splitter" id="splitter" aria-hidden="true"></div>

      <!-- Panel derecho con tabs de Errores / S√≠mbolos -->
      <aside class="side">
        <section class="panel" style="min-height:64%;">
          <div class="head">
            <div class="tabs">
              <div class="tab active" data-tab="errors">Errores</div>
              <div class="tab" data-tab="symbols">S√≠mbolos</div>
            </div>
            <div style="flex:1;"></div>
            <span class="chip" id="errorCount">0 errores</span>
          </div>
          <div class="body">
            <div id="errors"><div class="muted">Sin resultados todav√≠a.</div></div>
            <div id="symbols" style="display:none;"><div class="muted">Tabla de s√≠mbolos a√∫n no generada.</div></div>
          </div>
        </section>

        <section class="panel" style="min-height:28%;">
          <div class="head"><strong>Gu√≠a de uso</strong></div>
          <div class="body">
            <div class="muted">
              <p><b>Atajos</b><br/>
              ‚Ä¢ <code class="inline">Ctrl/Cmd + Enter</code> Analizar<br/>
              </p>
              <p><b>Sintaxis en clases</b><br/>
              ‚Ä¢ Campos: <code class="inline">let/var/const</code><br/>
              ‚Ä¢ M√©todos y constructor: <code class="inline">function</code><br/>
              </p>
              <p><b>Flujo del IDE</b><br/>
              1. Escribe o <em>Sube .cps</em>.<br/>
              2. Presiona <b>Analizar</b>.<br/>
              3. Revisa <b>Errores</b> o cambia a <b>S√≠mbolos</b>.<br/>
              </p>
            </div>
          </div>
        </section>
      </aside>
    </main>
  </div>

  <!-- Monaco via CDN -->
  <script src="https://unpkg.com/monaco-editor@0.45.0/min/vs/loader.js"></script>
  <script src="/static/main.js?v=11"></script>
</body>
</html>
